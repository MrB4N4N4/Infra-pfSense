## 인프라 구축 환경

- "인프라 보안" - 강병탁님

- "Esxi 가상 인프라 구축과 보안 솔루션을 활용한 이상 징후 탐지 모니터링 " - 보안프로젝트(인프런)

위 두 가지를 학습한 후 더 깊은 이해를 위해 직접 구성하였다. 실습 환경이 나와 맞지 않은 경우도 있었고 두 가지의 인프라를 혼합한 형태로 구축해 보고 싶었다.

~~큰 차이는 없고 웹 방화벽, IDS 의 위치, VLAN 구성 정도이다.~~

<br>

## Esxi 구성

Processors : 8

RAM : 24 GB

HARD : 500 GB

Network Adapter(3)

- Bridge(Esxi Management)

- Bridge(WAN), LAN Segment(LAN)

<br><br>

## Images

- 서버 : ubuntu-20.04
- 리눅스 데스크탑 : linuxmint-20
- IPS : pfSense-2.5.2
- IDS : SecurityOnion-16.04
- WAF : modsecurity
- 윈도우 : win7
- 취약한 웹 : bee-box-1.6
- 공격자 : Kali-21.2



## 네트워크 구성

__Esxi 내부 관점__ 의 구성이다. LAB 환경이므로, VLAN-DHCP이고 나머지는 Static으로 할당해주었다. 

 ~~DHCP 로 했다가 네트워크가 꼬여 Security Onion 재설치한 경험이 있다 ...~~

~~참고로, 원인은 'pfSense가 구동 되기 전에 다른 장비를 먼저 ON 해서'였다.~~

<br>

https://excalidraw.com/#json=Ddh8hF4NIr5yue_ksitu6,DdcFt_0bPSc0tncPbd94TQ

<br>

__라우터(WAN)__

- pfSense(IPS) : 방화벽
- WEB server(DMZ) : 웹 서버

__백본 스위치(LAN)__

__내부망 (VLANs)__

- VLAN10(SOC) : 'Security Operation Center'로 보안/네트워크 엔지니어들이 사용
- VLAN20(INTRA) : 내부망으로 인가된 직원만 접근 가능. DB, IDS, Splunk로 구성되어있음.
- VLAN30(DEV)  : 개발 본부. Window 환경 구성을 테스트하기 위해 추가하였다.

<br><br>

아직 회사 경험이 없어 지금까지 배운 지식을 토대로 네트워크를 구축했다.

비즈니스 모델, 방화벽, 네트워크 장비 등에 따라 구성을 다르게 될 것이므로 내가 하고 싶은 대로 구성하였다. ~~이것이 LAB의 장점!~~

<br>

## 네트워크 요구 사항

__DMZ__

- 취약한 웹 서비스(bee-box)

- 외부망(WAN)의 접근만 허용된다. (apt update 불가능)
- 내부에서는 보안팀과 개발팀만 접근 가능하다.

__VLAN10-SOC__

- 보안/네트워크 담당자가 사용하는 망

__VLAN20-INTRA__

- 

